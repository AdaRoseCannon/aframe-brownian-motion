!function(){"use strict";class t{constructor(t,e,s){this.x=t,this.y=e,this.z=s}dot2(t,e){return this.x*t+this.y*e}dot3(t,e,s){return this.x*t+this.y*e+this.z*s}}const e=[new t(1,1,0),new t(-1,1,0),new t(1,-1,0),new t(-1,-1,0),new t(1,0,1),new t(-1,0,1),new t(1,0,-1),new t(-1,0,-1),new t(0,1,1),new t(0,-1,1),new t(0,1,-1),new t(0,-1,-1)],s=new Uint8Array([151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180]),i=new Uint16Array(512),a=Array(512);function o(t){t>0&&t<1&&(t*=65536),(t=Math.floor(t))<256&&(t|=t<<8);for(let o=0;o<256;o++){let n;n=1&o?s[o]^255&t:s[o]^t>>8&255,i[o]=i[o+256]=n,a[o]=a[o+256]=e[n%12]}}function n(t){return t*t*t*(t*(6*t-15)+10)}function r(t,e,s){return(1-s)*t+s*e}function c(t,e){let s=Math.floor(t),o=Math.floor(e);t-=s,e-=o,s&=255,o&=255;const c=a[s+i[o]].dot2(t,e),h=a[s+i[o+1]].dot2(t,e-1),p=a[s+1+i[o]].dot2(t-1,e),d=a[s+1+i[o+1]].dot2(t-1,e-1),l=n(t);return r(r(c,p,l),r(h,d,l),n(e))}o(0);const h={spaceVector:{type:"array"},octaves:{default:2},positionVariance:{type:"vec3",default:new THREE.Vector3(1,1,1)},rotationVariance:{type:"vec3",default:new THREE.Vector3(10,10,10)},speed:{default:1}},p=new THREE.Vector2,d=new THREE.Vector3,l=new THREE.Vector3,f=new THREE.Euler(0,0,0,"ZXY"),u=new THREE.Quaternion,m=[0,0,0,0,0,0],E=new THREE.Vector3(1,1,1),w=new THREE.Matrix4,V={schema:h,description:"This component animates an object",init(){this.initialPosition=(new THREE.Vector3).copy(this.el.object3D.position),this.initialQuaternion=(new THREE.Quaternion).copy(this.el.object3D.quaternion),this.positionOffset=new THREE.Vector3,this.rotationOffset=new THREE.Vector3},update(){this.positionOffset.x=""===this.data.spaceVector[0]||void 0===this.data.spaceVector[0]?2e3*Math.random()-1e3:Number.parseFloat(this.data.spaceVector[0]),this.positionOffset.y=""===this.data.spaceVector[1]||void 0===this.data.spaceVector[1]?2e3*Math.random()-1e3:Number.parseFloat(this.data.spaceVector[1]),this.positionOffset.z=""===this.data.spaceVector[2]||void 0===this.data.spaceVector[2]?2e3*Math.random()-1e3:Number.parseFloat(this.data.spaceVector[2]),this.rotationOffset.x=""===this.data.spaceVector[3]||void 0===this.data.spaceVector[3]?2e3*Math.random()-1e3:Number.parseFloat(this.data.spaceVector[3]),this.rotationOffset.y=""===this.data.spaceVector[4]||void 0===this.data.spaceVector[4]?2e3*Math.random()-1e3:Number.parseFloat(this.data.spaceVector[4]),this.rotationOffset.z=""===this.data.spaceVector[5]||void 0===this.data.spaceVector[5]?2e3*Math.random()-1e3:Number.parseFloat(this.data.spaceVector[5])},seed(t){o(t)},fbm(t,e,s){let i=p.set(t,e),a=0,o=.5;for(let t=0;t<s;t++)a+=o*c(i.x,i.y),i.multiplyScalar(2),o*=.5;return a},updateNPNR(t,e,s){d.set(this.fbm(this.positionOffset.x+e[0]*s,this.data.speed*t/1e3,this.data.octaves),this.fbm(this.positionOffset.y+e[1]*s,this.data.speed*t/1e3,this.data.octaves),this.fbm(this.positionOffset.z+e[2]*s,this.data.speed*t/1e3,this.data.octaves)),l.set(this.fbm(this.rotationOffset.x+e[3]*s,this.data.speed*t/1e3,this.data.octaves),this.fbm(this.rotationOffset.y+e[4]*s,this.data.speed*t/1e3,this.data.octaves),this.fbm(this.rotationOffset.z+e[5]*s,this.data.speed*t/1e3,this.data.octaves)),d.multiply(this.data.positionVariance).multiplyScalar(1/.75),l.multiply(this.data.rotationVariance).multiplyScalar(1/.75)},tick(t){this.startTime||(this.startTime=t);const e=this.el.object3D;this.updateNPNR(t-this.startTime,m,0),e.position.copy(this.initialPosition).add(d),f.setFromVector3(l),u.setFromEuler(f),e.quaternion.copy(this.initialQuaternion).multiply(u)}},b={};Object.assign(b,V),b.schema=Object.assign({object:{type:"selector",description:"Which object to instance with brownian-motion"},showLine:{default:!1,description:"Whether to draw lines"},lineColor1:{type:"color",default:"orange",description:"Color of the first line"},lineColor2:{type:"color",default:"hotpink",description:"Color of the last line"},lineStart:{default:0,description:"Time stamp to start drawing the lines at"},lineStep:{default:20,description:"Steps to take in drawing the path"},lineEnd:{default:1e4,description:"Time stamp to stop drawing the lines at"},spaceVectorOffset:{type:"array",description:"Space vector offset for each instance/line"},count:{default:10,description:"Number of lines or instances"}},V.schema),b.update=function(){const t=this.data;V.update.call(this),this.spaceVectorOffset=[];for(let e=0;e<6;e++)this.spaceVectorOffset[e]=t.spaceVectorOffset[e]?Number(t.spaceVectorOffset[e]):0;if(this.el.getObject3D("brownianPathLines")&&this.el.removeObject3D("brownianPathLines"),t.showLine){const e=new THREE.Color(t.lineColor1),s=new THREE.Color(t.lineColor2),i=new THREE.Group;this.el.setObject3D("brownianPathLines",i);const a=[];for(let e=0;e<t.count;e++)a[e]=[];for(let e=t.lineStart;e<t.lineEnd;e+=t.lineStep)for(let s=0;s<t.count;s++)this.updateNPNR(e,this.spaceVectorOffset,s),a[s].push(d.clone());for(let o=0;o<t.count;o++){const t=new THREE.LineBasicMaterial({color:e.lerpHSL(s,o/(this.data.count-1))}),n=(new THREE.BufferGeometry).setFromPoints(a[o]),r=new THREE.Line(n,t);i.add(r)}}if(t.object){this.instances=this.instances||[];const e=this.instances,s=new THREE.Group;this.el.getObject3D("instances")&&this.el.removeObject3D("instances"),e.splice(0),t.object&&t.object.object3D.traverse((function(i){if(i.geometry&&i.material){const a=new THREE.InstancedMesh(i.geometry,i.material,t.count);a.instanceMatrix.setUsage(THREE.DynamicDrawUsage),e.push(a),s.add(a)}})),this.el.setObject3D("instances",s)}},b.tick=function(t){this.startTime||(this.startTime=t);for(let e=0;e<this.data.count;e++){this.updateNPNR(t-this.startTime,this.spaceVectorOffset,e),f.setFromVector3(l),u.setFromEuler(f),w.compose(d,u,E);for(const t of this.instances)t.setMatrixAt(e,w)}for(const t of this.instances)t.instanceMatrix.needsUpdate=!0},AFRAME.registerComponent("brownian-motion",V),AFRAME.registerComponent("brownian-path",b)}();
//# sourceMappingURL=aframe-brownian-motion.min.js.map
